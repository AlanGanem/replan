---

title: < Analytics Projetct Name >


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks_dev\index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks_dev\index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DELETE-THIS-SESSION-AFTER-EDITING">DELETE THIS SESSION AFTER EDITING<a class="anchor-link" href="#DELETE-THIS-SESSION-AFTER-EDITING"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="nx">javascript</span>
<span class="nx">IPython</span><span class="p">.</span><span class="nx">notebook</span><span class="p">.</span><span class="nx">kernel</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">&#39;nb_name = &quot;&#39;</span> <span class="o">+</span> <span class="nx">IPython</span><span class="p">.</span><span class="nx">notebook</span><span class="p">.</span><span class="nx">notebook_name</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<span class="c1">//DELETE THIS CELL AFTER EDITING THE NOTEBOOK</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="ea90eb7a-9536-4869-8eb3-ddf3b66d155d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ea90eb7a-9536-4869-8eb3-ddf3b66d155d');
IPython.notebook.kernel.execute('nb_name = "' + IPython.notebook.notebook_name + '"')
//DELETE THIS CELL AFTER EDITING THE NOTEBOOK

</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{nb_name}</span><span class="s1"> template has been left inaltered. Delete notebook or alter file and delete first cell&#39;</span><span class="p">)</span>
<span class="c1">#DELETE THIS CELL AFTER EDITING THE NOTEBOOK</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-module-packages-for-exemplification-in-readme/index">Import module packages for exemplification in readme/index<a class="anchor-link" href="#Import-module-packages-for-exemplification-in-readme/index"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">src.load</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.preprocess</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.build_features</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.fit</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.transform</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.validate</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.main</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Checklist">Checklist<a class="anchor-link" href="#Checklist"> </a></h2><p>Mark which tasks have been performed</p>
<ul>
<li>[ ] <strong>Summary:</strong> you have included a description, usage, output, accuracy and metadata of your model.</li>
<li>[ ] <strong>Pre-processing:</strong> you have applied pre-processing to your data and this function is reproducible to new datasets.</li>
<li>[ ] <strong>Feature selection:</strong> you have performed feature selection while modeling.</li>
<li>[ ] <strong>Modeling dataset creation:</strong> you have well-defined and reproducible code to generate a modeling dataset that reproduces the behavior of the target dataset.This pipeline is also applicable to generate the deploy dataset.</li>
<li>[ ] <strong>Model selection:</strong> you have chosen a suitable model according to the project specification.</li>
<li>[ ] <strong>Model validation:</strong> you have validated your model according to the project specification.</li>
<li>[ ] <strong>Model optimization:</strong> you have defined functions to optimize hyper-parameters and they are reproducible.</li>
<li>[ ] <strong>Peer-review:</strong> your code and results have been verified by your colleagues and pre-approved by them.</li>
<li>[ ] <strong>Acceptance:</strong> this model report has been accepted by the Data Science Manager. State name and date.</li>
</ul>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2><p>The model is designed to ... (state a simple sentence here to indicate what your model does)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2><p>Describe step-by-step what should be done to run the algorithm, as in the example below:</p>
<ol>
<li>Download the database from <code>&lt;path_to_file&gt;</code> and place it on an acessible folder in your machine</li>
<li>Clone this repository to your machine</li>
<li>Update the <code>path</code> variable in main, to the path chosen on step 1. </li>
<li>Make sure Python 3.6 is installed on your machine</li>
<li>Install all libraries on <code>requirements.txt</code> using the command:</li>
</ol>
<p><code>pip install -r requirements.txt</code></p>
<ol>
<li>Run the command <code>python src/main.py</code> </li>
<li>Check the results on the <code>output</code> directory</li>
</ol>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Output">Output<a class="anchor-link" href="#Output"> </a></h2><p>Clarify what are the files generated as output, with their names, paths and a brief description of the data structure (in case it is a CSV for example)</p>
<p>Example:</p>
<p>The model outputs a list called <code>&lt;name&gt;.csv</code> onto <code>&lt;name&gt;</code> and contains the following variables:</p>
<ul>
<li>var1</li>
<li>var2</li>
<li>var3</li>
<li>var4</li>
<li>var5</li>
<li>var6</li>
</ul>
<p>In the future, the Score variable (from the Credit risk algorithm) shall also be automatically merged onto the output file.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metadata"><a href="docs/project_metadata.json">Metadata</a><a class="anchor-link" href="#Metadata"> </a></h2><p>Here you should go the project metadata dictionary (written in JSON), as the file describes</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Performance-Metrics">Performance Metrics<a class="anchor-link" href="#Performance-Metrics"> </a></h2><p>The project will be followed by a dashboard, available as a source code on this repo.
The model is considered to be drifting when there are no visible distinction between clusters and/or when the KPI's are below the goal settled for the year.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-processing">Pre-processing<a class="anchor-link" href="#Pre-processing"> </a></h2><p>Here should be stated in a step-by-step way what was done in the pre-processing stage of the project.</p>
<p>Example:</p>
<ol>
<li>Excluded readings with <code>&lt;categories&gt;</code> from <code>&lt;rows&gt;</code>: bad lines.</li>
<li>Limited <code>&lt;name&gt;</code> to 4, which represents Bank payroll.</li>
<li>Excludes <code>&lt;name&gt;</code> readings with more than 30 days in advance, in case they represent more 1%. </li>
<li>Stacked all invoices by customer with the mean of each variable (although in some cases other aggregation functions are used instead).</li>
</ol>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-selection">Feature selection<a class="anchor-link" href="#Feature-selection"> </a></h2><p>Here should be explained how the features used for the model were selected, if any feature selection methodology was implemented and so on.</p>
<p>Example:</p>
<p>The feature selection methodology used was the Forward Selection. Also, some variables used on the Credit risk model were also considered, up until when the model reached its optimal performance. PCA and RFE did not present better results so far.</p>
<p><strong>Features used</strong></p>
<p>Here should be placed the features used to run the model entirely.</p>
<p>Example:</p>
<p>The features used to train both the clustering and classifier can be found under <code>models/config</code>, with the static variable <code>COLS_TO_TRAIN</code>.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modeling">Modeling<a class="anchor-link" href="#Modeling"> </a></h2><p>Here goes a better explanation on what algorithm was chosen and how does the complete model work.</p>
<p>Example:</p>
<p>To identify the clusters, the K-Means algorithm was chosen. A Random Forest Classifier from scikit-learn was then trained to predict the clusters for new customers and also customers with updated variable values. This pipeline has shown a good performance, running under 5 minutes and with satisfactory results.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-selection">Model selection<a class="anchor-link" href="#Model-selection"> </a></h2><p>Here should be stated a clarification on how it was decided to choose the running algorithm, and why not other ones. If any future implementations are envisioned, a brief statement should be made as well.</p>
<p>Example:</p>
<p>Although K-Medians normally performs better with outliers, K-Means still has shown more consistent results and therefore was decided to be used. K-Modes and K-Prototypes were also tested, for including categorical variables, but also had not either reached a good Silhouette Score or divided the data in a meaningful way. Spectral Clustering presented good results for a sample dataset, but has shown poor performance for the complete dataset, and still has to be studied for the next version. DBSCAN was considered, but since it neglects the outliers, it was then decided to be discarded.</p>
<p>For the classification algorithm, Random Forest outperformed the Decision Tree and the XGBoost classifiers.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-validation">Model validation<a class="anchor-link" href="#Model-validation"> </a></h2><p>A step-by-step explanation on what was done to choose the running model. The metrics measured to select them are also desired to be placed in the steps.</p>
<p>Example:</p>
<ol>
<li>The cluster numbers were chosen based on the Silhouette Score of 0,85.</li>
<li>The dataset was sampled to ensure the clustering consistency.</li>
<li>The clustered data was used as input for the Random Forest Classifier</li>
<li>The data was split into train and test (80/20).</li>
<li>The classifier reached the Accuracy Score of 0,96.</li>
</ol>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-optimization">Model optimization<a class="anchor-link" href="#Model-optimization"> </a></h2><p>Here should be explained if any kind of optimization of the model was made.</p>
<p>Example:</p>
<p>The hyper-parameters <code>n_estimators</code> and <code>max_depth</code> were manually optimized for the classifier, although there is still room for improvement, through GridSearch, Genetic Algorithms, etc.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Drifting-and-Retraining">Drifting and Retraining<a class="anchor-link" href="#Drifting-and-Retraining"> </a></h2><p>Here should be explained what are the necessary steps done in order to retrain the model, whenever some kind of drifting or underperformance is noticed.</p>
<p>Example:</p>
<p>Whenever drifting is noticed, lines 40, 41, 47, 56, 60 and 61 need to be uncommented on <code>main.py</code> before running the model. Once it is done, they need to be commented again. In future versions, this process is ought to be automated.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Foreseen-improvements">Foreseen improvements<a class="anchor-link" href="#Foreseen-improvements"> </a></h2><p>If any future improvements are identified during any of the steps, they should be pointed out in this section.</p>
<p>Example:</p>
<ul>
<li><p>New features to be engineered in the next versions can potentially enhance clustering or recommendations. For example, it is still to be tested whether there is a type of customer that only pays back on a specific time of the month or week, and therefore they won't show in the recommendations list when they don't pay.</p>
</li>
<li><p>Treating the (many) outliers with some other measures, could potentially enhance predictions.</p>
</li>
<li><p>Automatically gather data and run the model is something to be worked on for future versions</p>
</li>
</ul>

</div>
</div>
</div>
</div>
 

